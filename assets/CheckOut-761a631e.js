import{R as m,_ as g,y as v,P as S,z as y,o as i,c,a as t,Q as f,D as u,G as _,F as k,r as b,b as r,t as d,d as h,p as O,g as w}from"./index-a5c14a1a.js";class x{constructor(e="https://test1-pearl-omega.vercel.app/api/order"){this.api=m(e)}async addOrder(e){return(await this.api.post("/",e)).data}}const L=new x;const P={data(){return{userStore:v(),discountOrder:[["Ưu đãi cho đơn từ 120k",-2e4],["Ưu đãi cho đơn từ 300k",-2e4],["Ưu đãi cho đơn từ 500k",-2e4]],discountShip:[0,-15e3,"Free ship"]}},computed:{discountLevel(){return this.userStore.order.totalPrice>=5e5?2:this.userStore.order.totalPrice>=3e5?1:this.userStore.order.totalPrice>=12e4?0:-1},discountShipFee(){return this.discountLevel===1?this.discountShip[1]:0},totalOrder(){return this.discountLevel>-1?this.userStore.order.totalPrice+this.discountOrder[this.discountLevel][1]+this.discountShipFee:this.userStore.order.totalPrice}},methods:{async addOrder(){try{if(!confirm("Bạn đã kiểm tra kỹ đơn hàng chưa ?"))return;document.getElementById("btn-order").diabled=!0;let o=await L.addOrder({address:this.userStore.order.address,products:this.userStore.order.products,totalPrice:this.totalOrder,status:"ordered",user:this.userStore.user.id,note:this.userStore.order.note,freeShip:this.userStore.order.totalPrice>=5e5});this.userStore.order.products=[],this.userStore.order.totalPrice=0,this.userStore.setUserInfo(await S.verifyToken(localStorage.getItem("access-token"))),this.$router.push({name:"profile-user",params:{id:this.userStore.user.id}}),y(o.message,"success"),document.getElementById("btn-order").diabled=!1}catch(o){console.log(o),document.getElementById("btn-order").diabled=!1}},formatter(o){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o)}}},n=o=>(O("data-v-e8e7de86"),o=o(),w(),o),I={class:"checkout spad"},V={class:"container"},B={key:0},C={key:1,class:"checkout__form"},F={class:"row"},T={class:"col-lg-5 col-md-5"},$=n(()=>t("h4",{class:"checkout__title"},"Thông tin giao hàng",-1)),N={class:"checkout__input"},D=n(()=>t("p",null,[r("Họ và tên"),t("span",null,"*")],-1)),E=["value"],H={class:"checkout__input"},U=n(()=>t("p",null,[r("Số điện thoại"),t("span",null,"*")],-1)),q=["value"],K={class:"checkout__input"},z=n(()=>t("p",null,[r("Địa chỉ giao hàng"),t("span",null,"*")],-1)),A={class:"checkout__input"},G=n(()=>t("p",null,"Lưu ý khi giao hàng",-1)),M=n(()=>t("span",null,[t("i",null,"(Để điều chỉnh số lượng sản phẩm,...)")],-1)),Q={class:"col-lg-7 col-md-7"},R={class:"checkout__order"},j=n(()=>t("h4",{class:"order__title"},"Hoá đơn",-1)),J=n(()=>t("div",{class:"checkout__order__products"},[r(" Sản phẩm "),t("span",null,"Tổng")],-1)),W={class:"checkout__total__products"},X={key:0,class:"hr-item"},Y={style:{"max-width":"65%",float:"left"}},Z=n(()=>t("br",null,null,-1)),tt=["href"],et={class:"checkout__total__all"},st={key:0},rt={key:1},ot={key:2},nt=n(()=>t("span",{class:"marked"},[t("i",null,"- Lưu ý: "),r(" Hoá đơn này chưa bao gồm chi phí vận chuyển. Khách hàng thanh toán chi phí của hoá đơn và chi phí vận chuyển cho người giao hàng. ")],-1)),it=[nt],ct={key:3},dt=n(()=>t("span",{class:"marked"},[t("i",null,"- Lưu ý: "),r(" Khách hàng được "),t("b",null,"miễn phí tiền vận chuyển"),r(" (cho đơn từ 500k). Khách hàng chỉ cần thanh toán chi phí của hoá đơn cho người giao hàng. ")],-1)),at=[dt],ht=n(()=>t("button",{type:"submit",class:"primary-btn",id:"btn-order"}," Đặt hàng ",-1));function lt(o,e,p,ut,_t,a){return i(),c("section",I,[t("div",V,[this.userStore.totalPriceOrderComputer?(i(),c("div",C,[t("form",{onSubmit:e[3]||(e[3]=f(s=>this.addOrder(),["prevent"]))},[t("div",F,[t("div",T,[$,t("div",N,[D,t("input",{type:"text",value:this.userStore.user.full_name,disabled:""},null,8,E)]),t("div",H,[U,t("input",{type:"number",value:this.userStore.user.phone,disabled:""},null,8,q)]),t("div",K,[z,u(t("textarea",{rows:"2",style:{width:"100%","padding-left":"10px"},"onUpdate:modelValue":e[0]||(e[0]=s=>this.userStore.order.address=s)},null,512),[[_,this.userStore.order.address]])]),t("div",A,[G,u(t("textarea",{rows:"2",style:{width:"100%","padding-left":"10px"},placeholder:"VD: sđt người nhận hộ, thời gian nhận hàng,...","onUpdate:modelValue":e[1]||(e[1]=s=>this.userStore.order.note=s)},null,512),[[_,this.userStore.order.note]])]),t("button",{onClick:e[2]||(e[2]=s=>this.$router.push({name:"shopping-cart"})),class:"primary-btn",style:{width:"fit-content"}}," Quay lại giỏ hàng "),M]),t("div",Q,[t("div",R,[j,J,t("ul",W,[(i(!0),c(k,null,b(this.userStore.order.products,(s,l)=>(i(),c("li",{key:l},[l?(i(),c("hr",X)):h("",!0),t("span",Y,[r(d(`${s.title}  `)+" ",1),Z,r(" "+d(`[${a.formatter(s.price)}] [x${s.quantity}] [${s.size}]`)+" ",1),t("a",{href:s.color,target:"_blank"},"[Ảnh]",8,tt)]),t("span",null,d(a.formatter(s.price*s.quantity)),1)]))),128))]),t("ul",et,[t("li",null,[r(" Tạm tính "),t("span",null,d(a.formatter(this.userStore.order.totalPrice)),1)]),this.discountLevel>-1?(i(),c("li",st,[r(d(this.discountOrder[this.discountLevel][0])+" ",1),t("span",null,d(a.formatter(this.discountOrder[this.discountLevel][1])),1)])):h("",!0),this.discountLevel===1?(i(),c("li",rt,[r(" Giảm tiền vận chuyển "),t("span",null,d(a.formatter(this.discountShipFee)),1)])):h("",!0),t("li",null,[r(" Tổng cộng "),t("span",null,d(a.formatter(this.totalOrder)),1)]),this.userStore.order.totalPrice<5e5?(i(),c("li",ot,it)):(i(),c("li",ct,at))]),ht])])])],32)])):(i(),c("div",B," Hãy quay lại giỏ hàng do chưa có sản phẩm nào ! "))])])}const mt=g(P,[["render",lt],["__scopeId","data-v-e8e7de86"]]);export{mt as default};
