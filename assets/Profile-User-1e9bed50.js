import{_ as O,J as C,K as x,L as E,y as I,M as y,N as h,O as F,z as p,P as k,A as v,o as f,c as _,a as e,B as r,C as S,F as U,r as N,t as n,b as V,p as L,g as q}from"./index-a5c14a1a.js";const T={components:{Form:C,Field:x,ErrorMessage:E},props:{id:{type:String,required:!0}},data(){const s=I(),t=y().shape({passwordOld:h().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),passwordNew:h().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),passwordNewConfrim:h().oneOf([F("passwordNew"),null],"Mật khẩu nhập lại chưa khớp !")}),c=y().shape({full_name:h().required("Họ và tên phải có giá trị.").min(2,"Họ và tên phải ít nhất 13 ký tự.").max(50,"Họ và tên có nhiều nhất 50 ký tự."),address:h().required("Địa chỉ là bắt buộc.").max(100,"Địa chỉ tối đa 100 ký tự.")});return{userStore:s,dataUpdate:{full_name:"",address:""},dataPassword:{passwordOld:"",passwordNew:"",passwordNewConfrim:""},updateInfoFormSchema:c,changePasswordFormSchema:t,height:0,stateOfOrder:{ordered:"Đã đặt hàng",delivery:"Đang giao hàng",completed:"Đã hoàn thành"}}},computed:{heightOfProfileUser(){return(this.height-document.getElementsByClassName("header")[0].offsetHeight-document.getElementsByClassName("footer")[0].offsetHeight-0).toString()+"px"}},methods:{setUp(){document.querySelectorAll(".tablinks").forEach(t=>{t.addEventListener("click",c=>this.openTabs(c.currentTarget))})},openTabs(s){let t=document.querySelectorAll(".tablinks"),c=document.querySelectorAll(".tabcontent");var g=s.dataset.content;c.forEach(function(o){o.classList.remove("active")}),t.forEach(function(o){o.classList.remove("active")}),document.querySelector("#"+g).classList.add("active"),s.classList.add("active")},formatTime(s){return new Date(s).toLocaleString("vi-VN",{timeZone:"UTC"})},async updateInfoUser(){if(this.dataUpdate.full_name===this.userStore.user.full_name&&this.dataUpdate.address==this.userStore.user.address){p("Chưa có thông tin thay đổi để cập nhật !","warn");return}document.getElementById("open-form-dangky2").disabled=!0;const s=await k.updateInfoUser(this.userStore.user.id,this.dataUpdate);this.userStore.user.full_name=this.dataUpdate.full_name,this.userStore.user.address=this.dataUpdate.address,p(s.message,"success"),document.getElementById("open-form-dangky2").disabled=!1},async changePassword(){try{if(!this.dataPassword.passwordOld||!this.dataPassword.passwordNew){p("Vui lòng điền đầy đủ vào form Đổi mật khẩu !","warn");return}document.getElementById("open-form-dangky1").disabled=!0;const s=await k.changePassword(this.userStore.user.id,this.dataPassword);p(s.message,"success"),this.$refs.changPassword.resetForm(),document.getElementById("open-form-dangky1").disabled=!1}catch(s){p(s.response.data.message,"error"),document.getElementById("open-form-dangky1").disabled=!1}},resizeHandler(){this.height=window.innerHeight},formatter(s){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s)},toggleDetailsOrder(s){let t=document.querySelector(s);t.style.display==="none"?t.style.display="block":t.style.display="none"}},mounted(){this.setUp(),this.height=window.innerHeight,this.dataUpdate.full_name=this.userStore.user.full_name,this.dataUpdate.address=this.userStore.user.address},created(){window.addEventListener("resize",this.resizeHandler)},destroyed(){window.removeEventListener("resize",this.resizeHandler)}},d=s=>(L("data-v-241bfe96"),s=s(),q(),s),B={class:"container"},H=d(()=>e("div",{class:"tabs"},[e("button",{class:"tablinks active","data-content":"historyOrder"}," Lịch sử mua hàng "),e("button",{class:"tablinks","data-content":"updateInfo"},"Thông tin"),e("button",{class:"tablinks","data-content":"changePassword"}," Đổi mật khẩu ")],-1)),M={class:"wrapper_tabcontent"},z={id:"updateInfo",class:"tabcontent"},A=d(()=>e("div",{class:"modal-header"},[e("h3",{class:"auth-form-heading"},"Cập nhật thông tin")],-1)),D={class:"auth-form cach"},J={class:"form-group"},K=d(()=>e("label",{for:"phone"},"Số điện thoại",-1)),X={class:"form-group"},Z=d(()=>e("label",{for:"full_name"},"Họ và tên",-1)),j={class:"form-group"},G=d(()=>e("label",{for:"address"},"Địa chỉ",-1)),Q=d(()=>e("div",{class:"modal-footer"},[e("button",{id:"open-form-dangky2",class:"auth-form-btn-submit",type:"submit"}," Cập nhật ")],-1)),R={id:"changePassword",class:"tabcontent"},W=d(()=>e("div",{class:"modal-header"},[e("h3",{class:"auth-form-heading"},"Đổi mật khẩu")],-1)),Y={class:"auth-form cach bg-white"},$={class:"form-group"},ee=d(()=>e("label",{for:"passwordOld"},"Mật khẩu hiện tại",-1)),te={class:"form-group"},se=d(()=>e("label",{for:"passwordNew"},"Mật khẩu mới",-1)),ae={class:"form-group"},oe=d(()=>e("label",{for:"passwordNewConfrim"},"Xác nhận mật khẩu mới",-1)),re=d(()=>e("div",{class:"modal-footer"},[e("button",{id:"open-form-dangky1",class:"auth-form-btn-submit",type:"submit"}," Đổi mật khẩu ")],-1)),de={id:"historyOrder",class:"tabcontent active"},ne={class:"container-fluid col-12"},le=["onClick"],ie=d(()=>e("button",null,"Chi tiết",-1)),ce=[ie],ue=["id"],me=d(()=>e("div",{class:"container-fluid row"},[e("div",{class:"col col-lg-9 col-md-9 col-sm-9 col-9"},[e("b",null,"Sản phẩm")]),e("div",{class:"col col-lg-3 col-md-3 col-sm-3 col-3",style:{"text-align":"right"}},[e("b",null,"Tổng")])],-1)),he={class:"col col-lg-9 col-md-9 col-sm-9 col-9"},pe=d(()=>e("br",null,null,-1)),fe=["href"],_e={class:"col col-lg-3 col-md-3 col-sm-3 col-3",style:{"text-align":"right"}};function ge(s,t,c,g,o,i){const u=v("Field"),m=v("ErrorMessage"),b=v("Form");return f(),_("div",B,[H,e("div",M,[e("div",z,[A,e("div",D,[r(b,{onSubmit:t[3]||(t[3]=a=>i.updateInfoUser()),"validation-schema":o.updateInfoFormSchema},{default:S(()=>[e("div",J,[K,r(u,{name:"phone",type:"tel",class:"form-control",disabled:"",modelValue:this.userStore.user.phone,"onUpdate:modelValue":t[0]||(t[0]=a=>this.userStore.user.phone=a)},null,8,["modelValue"]),r(m,{name:"phone",class:"error-feedback"})]),e("div",X,[Z,e("div",null,[r(u,{name:"full_name",type:"text",class:"form-control",modelValue:o.dataUpdate.full_name,"onUpdate:modelValue":t[1]||(t[1]=a=>o.dataUpdate.full_name=a)},null,8,["modelValue"]),r(m,{name:"full_name",class:"error-feedback"})])]),e("div",j,[G,e("div",null,[r(u,{name:"address",type:"text",class:"form-control",modelValue:o.dataUpdate.address,"onUpdate:modelValue":t[2]||(t[2]=a=>o.dataUpdate.address=a)},null,8,["modelValue"]),r(m,{name:"address",class:"error-feedback"})])]),Q]),_:1},8,["validation-schema"])])]),e("div",R,[W,e("div",Y,[r(b,{onSubmit:t[7]||(t[7]=a=>i.changePassword()),ref:"changPassword","validation-schema":o.changePasswordFormSchema},{default:S(()=>[e("div",$,[ee,e("div",null,[r(u,{name:"passwordOld",type:"password",class:"form-control",modelValue:o.dataPassword.passwordOld,"onUpdate:modelValue":t[4]||(t[4]=a=>o.dataPassword.passwordOld=a)},null,8,["modelValue"]),r(m,{name:"passwordOld",class:"error-feedback"})])]),e("div",te,[se,e("div",null,[r(u,{name:"passwordNew",type:"password",class:"form-control",modelValue:o.dataPassword.passwordNew,"onUpdate:modelValue":t[5]||(t[5]=a=>o.dataPassword.passwordNew=a)},null,8,["modelValue"]),r(m,{name:"passwordNew",class:"error-feedback"})])]),e("div",ae,[oe,e("div",null,[r(u,{name:"passwordNewConfrim",type:"password",class:"form-control",modelValue:o.dataPassword.passwordNewConfrim,"onUpdate:modelValue":t[6]||(t[6]=a=>o.dataPassword.passwordNewConfrim=a)},null,8,["modelValue"]),r(m,{name:"passwordNewConfrim",class:"error-feedback"})])]),re]),_:1},8,["validation-schema"])])]),e("div",de,[(f(!0),_(U,null,N(this.userStore.user.orders,(a,w)=>(f(),_("div",{class:"container-fluid row",key:w,style:{"padding-top":"10px","padding-bottom":"10px","border-bottom":"1px solid #111111"}},[e("div",ne,[e("div",null,[e("b",null,"Đơn hàng #"+n(a._id),1)]),e("div",null,"- Trạng thái: "+n(this.stateOfOrder[a.status]),1),e("div",null,"- Thời gian đặt hàng: "+n(i.formatTime(a.time)),1),e("div",null," - Tổng giá trị: "+n(i.formatter(a.totalPrice))+" "+n(a.freeShip?" (Free ship)":""),1),e("div",null,"- Địa chỉ nhận hàng: "+n(a.address),1),e("div",null,"- Lưu ý khi giao hàng: "+n(a.note),1),e("div",{class:"btn-details-order",onClick:l=>i.toggleDetailsOrder("#detail-order"+w)},ce,8,le),e("div",{class:"details-order",id:"detail-order"+w,style:{display:"none"}},[me,(f(!0),_(U,null,N(a.products,(l,P)=>(f(),_("div",{class:"container-fluid row",key:P,style:{"border-bottom":"0.5px dotted #111111"}},[e("div",he,[V(n(`${l.title} `)+" ",1),pe,V(" "+n(` [${i.formatter(l.price)}] [x${l.quantity}] [${l.size}] `)+" ",1),e("a",{href:l.color,target:"_blank"},"[Ảnh]",8,fe)]),e("div",_e,n(i.formatter(l.price*l.quantity)),1)]))),128))],8,ue)])]))),128))])])])}const ve=O(T,[["render",ge],["__scopeId","data-v-241bfe96"]]);export{ve as default};
